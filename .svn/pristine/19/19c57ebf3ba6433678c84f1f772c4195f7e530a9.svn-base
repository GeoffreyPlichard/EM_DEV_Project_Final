<?php

namespace Mobility\PublicBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;
// Import des modules
use Sensio\Bundle\FrameworkExtraBundle\Configuration\Route;
use Sensio\Bundle\FrameworkExtraBundle\Configuration\Template;
use Sensio\Bundle\FrameworkExtraBundle\Configuration\Configuration;

// On importe la classe Request pour afficher un formulaire
use Symfony\Component\HttpFoundation\Request as Request;

// Pour afficher un formulaire, importer les types
use Mobility\PublicBundle\Form\Participation\ParticipationType;


class FrontPagesController extends Controller
{

	/**
	* @Route(name="public.frontpages.index")
	* @Template("PublicBundle:FrontPages:index.html.twig")
	*/

    public function indexAction()
    {
        return array();
    }


	/**
	* @Route("/actualites", name="public.frontpages.actualites")
	* @Template("PublicBundle:FrontPages:actualites.html.twig")
	*/

    public function actualitesAction()
    {
        return array();
    }


    /**
	* @Route("/projet", name="public.frontpages.projet")
	* @Template("PublicBundle:FrontPages:projet.html.twig")
	*/	

	public function projetAction()
	{
		return array();
	}


	/**
	* @Route("/experiences", name="public.frontpages.experiences")
	* @Template("PublicBundle:FrontPages:experiences.html.twig")
	*/

	public function experiencesAction()
	{
		return array();
	}


	/**
	* @Route("/experience", name="public.frontpages.experience")
	* @Template("PublicBundle:FrontPages:experience.html.twig")
	*/

	public function experienceAction()
	{
		return array();
	}	


	/**
	* @Route("/participe", name="public.frontpages.participe")
	* @Template("PublicBundle:FrontPages:participe.html.twig")
	*/

	public function participeAction(Request $request)
	{

		$type = new ParticipationType();

		$form = $this->createForm($type);
		$form->handleRequest($request);

		$doctrine = $this->getDoctrine();
		$em = $doctrine->getManager();

		if ($form->isValid())
        {
            $data = $form->getData();

            $em->persist($data);
            $em->flush();

            # getFlashBab() stocke un message en session une seule fois : une fois affiché il est détruit
            $request->getSession()->getFlashBag()->set('notice', 'Votre article a bien été ajouté !');

            # Créé une URL
            $url = $this->generateUrl('public.frontpages.participe');
            # On fait la redirection
            return $this->redirect($url);

           
        }

		return array(
			'form' => $form->createView()
		);
	}


	/**
	* @Route("/contact", name="public.frontpages.contact")
	* @Template("PublicBundle:FrontPages:contact.html.twig")
	*/

	public function contactAction()
	{
		return array();
	}


	/**
	* @Route("/legals", name="public.frontpages.legals")
	* @Template("PublicBundle:FrontPages:legals.html.twig")
	*/

	public function legalsAction()
	{
		return array();
	}
}
